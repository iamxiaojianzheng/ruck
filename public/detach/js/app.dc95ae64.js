(function(){"use strict";var e={3649:function(e,n,t){var i=t(9005),o=t(4851),a=t(3111),l=t(2499),u=t(476),c=t.n(u);t(3227);const r={class:"plugin-menu-container"},s={key:0,class:"window-handle"},d=["title"];var p=(0,o.pM)({__name:"PluginMenu",props:{config:{type:Object,required:!0},currentPlugin:{type:Object,default:()=>({})},showDetachOption:{type:Boolean,default:!0},isDetach:{type:Boolean,default:!1},pinStatus:{type:Boolean,default:!1},isDev:{type:Boolean,default:!1}},emits:["updateConfig","detach","togglePin","openDevTool","minimize","maximize","close"],setup(e,{emit:n}){const t=window.require("process"),i=window.require("@electron/remote"),{Menu:u}=i,c=e,p=n,{config:v,currentPlugin:m,showDetachOption:w,isDetach:h,pinStatus:f,isDev:g}=(0,l.QW)(c),y=()=>{const e=m.value.name;return v.value.pluginSettings?.[e]?.autoDetach||!1},b=async()=>{const e=m.value.name,n=v.value.pluginSettings?.[e]?.autoDetach||!1,t=await window.detachAPI.updatePluginSetting(e,"autoDetach",!n);p("updateConfig",t)},k=()=>{let e=JSON.parse(JSON.stringify(v.value));e.perf.common.hideOnBlur=!e.perf.common.hideOnBlur,p("updateConfig",e)},C=e=>{let n=JSON.parse(JSON.stringify(v.value));n.perf.common.lang=e,p("updateConfig",n)},O=()=>{let e=[];if(h.value||e.push({label:v.value.perf.common.hideOnBlur?"钉住":"自动隐藏",click:k}),e.push({label:"zh-CN"===v.value.perf.common.lang?"切换语言":"Change Language",submenu:[{label:"简体中文",click:()=>{C("zh-CN")}},{label:"English",click:()=>{C("en-US")}}]}),m.value&&m.value.logo){const n=[{label:"插件应用设置",submenu:[{label:"自动分离为独立窗口",type:"checkbox",checked:y(),click:b}]}];w.value&&n.push({label:"分离窗口",click:()=>{p("detach")}}),e=e.concat(n)}const n=u.buildFromTemplate(e);n.popup()};return(e,n)=>((0,o.uX)(),(0,o.CE)("div",r,["darwin"!==(0,l.R1)(t).platform&&(0,l.R1)(h)?((0,o.uX)(),(0,o.CE)("div",s,[(0,l.R1)(g)?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"devtool",onClick:n[0]||(n[0]=e=>p("openDevTool")),title:"开发者工具"})):(0,o.Q3)("",!0),(0,l.R1)(h)?((0,o.uX)(),(0,o.CE)("div",{key:1,class:(0,a.C4)((0,l.R1)(f)?"pin":"unpin"),onClick:n[1]||(n[1]=e=>p("togglePin")),title:(0,l.R1)(f)?"取消置顶":"置顶"},null,10,d)):(0,o.Q3)("",!0),(0,o.Lk)("div",{class:"more",onClick:O}),(0,o.Lk)("div",{class:"minimize",onClick:n[2]||(n[2]=e=>p("minimize"))}),(0,o.Lk)("div",{class:"maximize",onClick:n[3]||(n[3]=e=>p("maximize"))}),(0,o.Lk)("div",{class:"close",onClick:n[4]||(n[4]=e=>p("close"))})])):(0,o.Q3)("",!0)]))}}),v=t(2515);const m=(0,v.A)(p,[["__scopeId","data-v-53ca3942"]]);var w=m;const h={class:"info"},f=["src"],g=["value","placeholder"],y={key:1};var b={__name:"App",setup(e){const{ipcRenderer:n}=window.require("electron"),t=window.require("process"),i=(0,l.KR)(!1),u=(0,l.KR)(!1),r=localStorage.getItem("rubick-system-detach")||"{}",s=(0,l.KR)({}),d=(0,l.KR)({});window.initDetach=async e=>{const{subInput:n}=e;s.value=e,s.value.pin=!1,i.value=n&&(!!n.value||!!n.placeholder),localStorage.setItem("rubick-system-detach",JSON.stringify(e)),u.value=await window.detachAPI.isDev();try{d.value=await window.detachAPI.getConfig()||{}}catch(t){console.error(t)}};const p=(0,o.EW)(()=>{const{pin:e}=s.value;return!0===e});try{window.initDetach(JSON.parse(r))}catch(I){}const v=c()(e=>{window.detachAPI.detachInputChange(e.target.value)},500),m=()=>{window.detachAPI.openDevTools()},b=()=>{console.log("pin");const{pin:e}=s.value;e?window.detachAPI.unpin():window.detachAPI.pin(),s.value.pin=!e},k=e=>{e&&(d.value=e)},C=()=>{window.detachAPI.minimize()},O=()=>{window.detachAPI.maximize()},S=()=>{window.detachAPI.close()};return Object.assign(window,{setSubInputValue:({value:e})=>{s.value.subInput.value=e},setSubInput:e=>{s.value.subInput.placeholder=e},removeSubInput:()=>{s.value.subInput=null}}),window.enterFullScreenTrigger=()=>{document.querySelector(".detach").classList.remove("darwin")},window.leaveFullScreenTrigger=()=>{const e=document.querySelector(".detach");e.classList.contains("darwin")||e.classList.add("darwin")},window.maximizeTrigger=()=>{const e=document.querySelector(".maximize");e&&!e.classList.contains("unmaximize")&&e.classList.add("unmaximize")},window.unmaximizeTrigger=()=>{const e=document.querySelector(".maximize");e&&e.classList.remove("unmaximize")},"darwin"===t.platform?window.onkeydown=e=>{"Escape"!==e.code?!e.metaKey||"KeyW"!==e.code&&"KeyQ"!==e.code||window.handle.close():window.detachAPI.endFullScreen()}:window.onkeydown=e=>{e.ctrlKey&&"KeyW"===e.code&&window.handle.close()},(e,n)=>((0,o.uX)(),(0,o.CE)("div",{class:(0,a.C4)([(0,l.R1)(t).platform,"detach"])},[(0,o.Lk)("div",h,[(0,o.Lk)("img",{src:s.value.logo},null,8,f),i.value?((0,o.uX)(),(0,o.CE)("input",{key:0,autofocus:"",onInput:n[0]||(n[0]=(...e)=>(0,l.R1)(v)&&(0,l.R1)(v)(...e)),value:s.value.subInput?.value,placeholder:s.value.subInput?.placeholder},null,40,g)):((0,o.uX)(),(0,o.CE)("span",y,(0,a.v_)(s.value.pluginName),1))]),(0,o.bF)(w,{config:d.value,currentPlugin:s.value,showDetachOption:!1,isDetach:!0,pinStatus:p.value,isDev:u.value,onUpdateConfig:k,onTogglePin:b,onOpenDevTool:m,onMinimize:C,onMaximize:O,onClose:S},null,8,["config","currentPlugin","pinStatus","isDev"])],2))}};const k=b;var C=k;(0,i.Ef)(C).mount("#app")}},n={};function t(i){var o=n[i];if(void 0!==o)return o.exports;var a=n[i]={exports:{}};return e[i].call(a.exports,a,a.exports,t),a.exports}t.m=e,function(){var e=[];t.O=function(n,i,o,a){if(!i){var l=1/0;for(s=0;s<e.length;s++){i=e[s][0],o=e[s][1],a=e[s][2];for(var u=!0,c=0;c<i.length;c++)(!1&a||l>=a)&&Object.keys(t.O).every(function(e){return t.O[e](i[c])})?i.splice(c--,1):(u=!1,a<l&&(l=a));if(u){e.splice(s--,1);var r=o();void 0!==r&&(n=r)}}return n}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[i,o,a]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,i){var o,a,l=i[0],u=i[1],c=i[2],r=0;if(l.some(function(n){return 0!==e[n]})){for(o in u)t.o(u,o)&&(t.m[o]=u[o]);if(c)var s=c(t)}for(n&&n(i);r<l.length;r++)a=l[r],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(s)},i=self["webpackChunkdetach"]=self["webpackChunkdetach"]||[];i.forEach(n.bind(null,0)),i.push=n.bind(null,i.push.bind(i))}();var i=t.O(void 0,[504],function(){return t(3649)});i=t.O(i)})();